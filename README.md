# Реакция полимеризации

## Постановка задачи

Простейшая реакция катализа записывается в виде: 
```math
(A+B\xrightarrow{k}A+C). 
```
Динамику концентрации вещества $A$ и $B$ при этом можно описать при помощи следующей системы дифференциальных уравнений:
```math
\frac{dB}{dt} = -kAB,\\
\frac{dC}{dt} = kAB.
```
В Системе уравнений $A = \frac{N_{A}}{V_{0}}$, $B=\frac{N_{B}}{V_{0}}$, $C=\frac{N_{C}}{V_{0}}$, $k$ — кинетическая константа скорости реакции, 

$N_{A}, N_{B}, N_{C}$ — количество реагентов типа $A$, $B$ и $C$ соответственно, $V_{0}$ — объем системы. 
Решение системы:
```math
B = B_{0}e^{-kAt},\\
C = B_{0}-B=B_{0}(1-e^{-kAt}).
```
Реагирующая система может быть описана в виде конечного объема со случайным начальным распределением $N$ частиц в нем и заданными периодическими граничными условиями. Будем считать, что реакция происходит с некоторой вероятностью $p=0.001$ когда частицы $A$ и $B$ находятся ближе чем $r_c=4.0$ друг к другу. Взаимодействие частиц можно описать при помощи следущего потенциала:
```math
V(\vec{r}_i,\vec{r}_j)=\varepsilon\left[Q_{1}\left(\frac{\sigma}{r_{ij}}\right)^{4} + Q_{2}\left(\frac{\sigma}{r_{ij}}\right)^2\right],
```
где $ε=1$ — энергетическая постоянная, $σ=1$ — равновесное расстояние между частицами, $Q_{1}$ и $Q_{2}$ — константы, $r_{ij}=|r_{i}-r_{j}|$ — текущее расстояние между частицами. Если задать постоянные $Q_{1}=1$, $Q_{2}=-2$, то взаимодействие между частицами будет притягивающим, а при $Q_{1}=0$, $Q_{2}=1$ — отталкивающим. Допустим, что продукт реакции $C$ полимеризуется. Тогда результатом реакции будет полимер, состоящий из молекул типа $C$. Для описания процесса полимеризации предлагается использовать потенциал c притягивающими постоянными $Q_{1}=1$ и $Q_{2}=-3$ в случае, если обе частицы имеют тип $C$ и отталкивающие $Q_{1}=0$, $Q_{2}=1$ в другом случае.
Движение частиц описывается уравнениями Ланжевена:
```math
m\frac{d^2\mathbf{r}_i}{dt^2}=-\nabla_iV-\lambda\frac{d\mathbf{r}_i}{dt}+\eta_i(t),
```
где $m = 1.0$ — масса частиц, $V(r_{i}) = V_{cov}(r_{i}) + V_{hic}(r_{i})$ — потенциальная энергия системы, $∇_i V$ — градиент потенциала по координате $i$-ой частицы. $η_i(t)$ — случайная сила, описывающая соударения с молекулами воды с нормальным распределением:
```math
<η_i(t) η_j(t)> = 2 λ k_BT δ_{ij} δ(t-t')
```
Динамику Ланжевена можно рассматривать как динамику Ньютона с добавлением двух дополнительных сил: силы трения, пропорциональной скорости частицы и случайной силы, распределенной по Гауссу. Коэффициент пропорциональности λ называется коэфициентом демпфирования и задает силу влияния среды на молекулу. При больших λ система переходит к Брауновскому движению, при малых — к Ньютоновскому.
Для численного решения уравнения Ланжевена можно использовать следующую разностную схему:
```math
m_i\frac{v_{i}^{n+\frac{1}{2}}-v_{i}^{n-\frac{1}{2}}}{τ} = f_{i}^{n} - λ m_i\frac{v_{i}^{n+\frac{1}{2}}+v_{i}^{n-\frac{1}{2}}}{2}+\sqrt{\frac{2k_B T λ m_i}{τ}} r_i^f
```
```math
\frac{r_{i}^{n+1}-r_{i}^{n}}{τ} = v_{i}^{n+\frac{1}{2}}
```
Здесь $λ=50$ — коэфициент демпфирования, $r_i^f$ — вектор из трех нормально распределенных случайных величин, с дисперсией 1 и математическим ожиданием 0. Постоянная Больцмана $k_B=8.31\times10^{-3}$  $кДж/K*моль$, шаг по времени $τ=0.001$ пс, температура $T=300$ K.

## Отрисовка
Отрисовка выполняется при помощи программы Visual Molecular Dynamics. 
